import{p as e,H as t,c as i,h as r,d as s}from"./p-BQgY5XdM.js";import{h as o,o as l,a,i as d}from"./p-DOKR5HKI.js";import{d as u,g as c,r as n}from"./p-1b8Kykha.js";import{d as p}from"./p-Dff2I2ku.js";import{d as f}from"./p-CZq1Zpp8.js";import{d as h}from"./p-CwNv12Ch.js";import{d as g}from"./p-Cc9yC5rG.js";import{d as b}from"./p-DsBMhwRl.js";import{d as m}from"./p-DeFvi7Po.js";const v={en:{button:{remove:"Remove",upload:"Choose file"},summary:{selected:"Currently selected:",unselected:"No file currently selected."},removeFile:"Remove file",droppedError:"One or more of the dropped files is unable to be uploaded. Accepted file types:"},fr:{button:{remove:"Supprimer",upload:"Choisir un fichier"},summary:{selected:"Actuellement sélectionné:",unselected:"Aucun fichier actuellement sélectionné."},removeFile:"Supprimer le fichier",droppedError:"Un ou plusieurs fichiers déposés ne peuvent pas être téléversés. Types de fichiers acceptés :"}};const w="@layer reset, default, input, files, disabled, error, focus, active;@layer reset{:host{display:block}:host .gcds-file-uploader-wrapper{border:0;margin:0;padding:0}:host .gcds-file-uploader-wrapper button{cursor:pointer;font:inherit;outline:0}}@layer default{:host .gcds-file-uploader-wrapper{align-items:flex-start;color:var(--gcds-file-uploader-default-text);display:flex;flex-direction:column;font:var(--gcds-file-uploader-font-desktop);max-width:90%;transition:color .15s ease-in-out}@media only screen and (width < 48em){:host .gcds-file-uploader-wrapper{font:var(--gcds-file-uploader-font-mobile)}}:host .gcds-file-uploader-wrapper button{border-radius:var(--gcds-file-uploader-file-button-border-radius);transition:all .15s ease-in-out}}@layer input{:host .gcds-file-uploader-wrapper .file-uploader__input{display:inline-block;position:relative}:host .gcds-file-uploader-wrapper .file-uploader__input button{background-color:var(--gcds-file-uploader-button-background);border:var(--gcds-file-uploader-button-border-width) solid var(--gcds-file-uploader-button-text);color:var(--gcds-file-uploader-button-text);font-weight:var(--gcds-file-uploader-button-font-weight);margin:var(--gcds-file-uploader-button-margin);padding:var(--gcds-file-uploader-button-padding)}:host .gcds-file-uploader-wrapper .file-uploader__input input{cursor:pointer;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%}:host .gcds-file-uploader-wrapper .file-uploader__input input::-webkit-file-upload-button{cursor:pointer}:host .gcds-file-uploader-wrapper .file-uploader__input #file-uploader__summary{height:0;margin:0;overflow:hidden;visibility:hidden}}@layer files{:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file{align-items:center;border:var(--gcds-file-uploader-file-border-width) solid var(--gcds-file-uploader-file-border-color);display:flex;justify-content:space-between;max-width:var(--gcds-file-uploader-file-max-width);padding:var(--gcds-file-uploader-file-padding);width:100%}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file:not(:last-of-type){border-block-end:0}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file:last-of-type{margin:var(--gcds-file-uploader-button-margin)}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file gcds-text{overflow:auto}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file gcds-text::part(text){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file button{align-items:center;background:transparent;border:0;color:var(--gcds-file-uploader-file-button-default-text);display:flex;font-weight:var(--gcds-file-uploader-button-font-weight);margin:var(--gcds-file-uploader-file-button-margin);padding:var(--gcds-file-uploader-file-button-padding)}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file button:not(:focus) span{overflow:visible;text-decoration:underline var(--gcds-file-uploader-file-button-default-decoration-thickness);text-underline-offset:var(\n          --gcds-file-uploader-file-button-underline-offset\n        )}}@layer disabled{:host .gcds-file-uploader-wrapper.gcds-disabled{color:var(--gcds-file-uploader-disabled-text)}:host .gcds-file-uploader-wrapper.gcds-disabled gcds-label{--gcds-label-text:currentColor}:host .gcds-file-uploader-wrapper.gcds-disabled gcds-hint{--gcds-hint-text:currentColor}:host .gcds-file-uploader-wrapper.gcds-disabled :is(.file-uploader__input,.file-uploader__uploaded-file){pointer-events:none}:host .gcds-file-uploader-wrapper.gcds-disabled .file-uploader__input button,:host .gcds-file-uploader-wrapper.gcds-disabled .file-uploader__uploaded-file,:host .gcds-file-uploader-wrapper.gcds-disabled .file-uploader__uploaded-file button{color:inherit}:host .gcds-file-uploader-wrapper.gcds-disabled .file-uploader__input button{background-color:var(--gcds-file-uploader-disabled-background);border-color:currentColor}}@layer error{:host .gcds-file-uploader-wrapper.gcds-error .file-uploader__uploaded-file{border-color:var(--gcds-file-uploader-file-danger-border-color)}}@layer hover{@media (hover:hover){:host .gcds-file-uploader-wrapper .file-uploader__input:not(:focus-within):hover button{background-color:var(--gcds-file-uploader-hover-button-background)}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file button:not(:focus):hover{color:var(--gcds-file-uploader-file-button-hover-text)}:host .gcds-file-uploader-wrapper .file-uploader__uploaded-file button:not(:focus):hover span{text-decoration-thickness:var(\n            --gcds-file-uploader-file-button-hover-decoration-thickness\n          )}}}@layer focus{:host .gcds-file-uploader-wrapper:focus-within .file-uploader__uploaded-file:focus-within{border-color:var(--gcds-file-uploader-file-focus-border-color)}:host .gcds-file-uploader-wrapper:focus-within .file-uploader__input:focus-within button,:host .gcds-file-uploader-wrapper:focus-within .file-uploader__uploaded-file button:focus{background-color:var(--gcds-file-uploader-focus-button-background);border-color:var(--gcds-file-uploader-focus-button-background);color:var(--gcds-file-uploader-focus-button-text);outline:var(--gcds-file-uploader-button-outline-width) solid var(--gcds-file-uploader-focus-button-background);outline-offset:var(--gcds-file-uploader-focus-button-outline-offset)}}@layer active{:host .gcds-file-uploader-wrapper .file-uploader__input:has(input:active) button{background-color:var(--gcds-file-uploader-active-button-background);border-color:var(--gcds-file-uploader-active-button-background);color:var(--gcds-file-uploader-active-button-text)}}";const _=e(class e extends t{constructor(){super();this.__registerHost();this.__attachShadow();this.gcdsFocus=i(this,"gcdsFocus");this.gcdsBlur=i(this,"gcdsBlur");this.gcdsChange=i(this,"gcdsChange");this.gcdsInput=i(this,"gcdsInput");this.gcdsRemoveFile=i(this,"gcdsRemoveFile");this.gcdsError=i(this,"gcdsError");this.gcdsValid=i(this,"gcdsValid");this.internals=this.attachInternals();this.inputTitle="";this._validator=u;this.hideLabel=false;this.required=false;this.disabled=false;this.value=[];this.validateOn="blur";this.inheritedAttributes={};this.onBlur=()=>{if(this.validateOn=="blur"){this.validate()}this.gcdsBlur.emit()};this.handleInput=(e,t)=>{const i=[];const r=Array.from(e.target.files);this.files=e.target.files;r.map((e=>{i.push(e["name"])}));this.addFilesToFormData(r);this.value=[...i];if(this.validateOn=="blur"){setTimeout((()=>{this.validate()}),100)}if(e.type==="change"){const t=new e.constructor(e.type,e);this.el.dispatchEvent(t)}else{this.updateValidity()}t.emit(this.value)};this.removeFile=e=>{e.preventDefault();const t=e.target.closest(".file-uploader__uploaded-file").childNodes[0].textContent;const i=this.value;const r=i.indexOf(t);if(r>-1){i.splice(r,1);const e=new DataTransfer;for(let i=0;i<this.shadowElement.files.length;i++){if(this.shadowElement.files[i].name!=t){e.items.add(this.shadowElement.files[i])}}this.shadowElement.files=e.files;this.files=e.files;this.addFilesToFormData(Array.from(this.shadowElement.files))}this.value=[...i];this.gcdsRemoveFile.emit(this.value);this.gcdsChange.emit(this.value);this.el.dispatchEvent(new Event("change",{bubbles:true,composed:true}));this.updateValidity()};this.addFilesToFormData=e=>{const t=new FormData;if(e.length>0){e.forEach((e=>{t.append(this.name,e,e.name)}))}this.internals.setFormValue(t)}}validateDisabledSelect(){if(this.required){this.disabled=false}}watchFiles(){const e=[];const t=Array.from(this.files);t.map((t=>{e.push(t["name"])}));this.addFilesToFormData(t);this.value=[...e]}validateErrorMessage(){if(this.disabled){this.errorMessage=""}else if(!this.hasError&&this.errorMessage){this.hasError=true}else if(this.errorMessage==""){this.hasError=false}}validateValidator(){this._validator=c(this.validator)}validateHasError(){if(this.disabled){this.hasError=false}}get validity(){return this.internals.validity}async validate(){o(this.el,this._validator.validate(this.shadowElement.files),this.label,this.gcdsError,this.gcdsValid,this.lang);this.inputTitle=this.errorMessage}async checkValidity(){return this.internals.checkValidity()}async getValidationMessage(){return this.internals.validationMessage}submitListener(e){if(e.target==this.el.closest("form")){if(this.validateOn&&this.validateOn!="other"){this.validate()}if(this.hasError&&this.validateOn!="other"){e.preventDefault()}}}formResetCallback(){this.internals.setFormValue("");this.value=[]}formStateRestoreCallback(e){this.internals.setFormValue(e);this.value=e}updateValidity(){if(!this.shadowElement)return;const e=this.shadowElement.validity;let t=null;if(e===null||e===void 0?void 0:e.valueMissing){t=this.lang==="en"?"You must upload a file to continue.":"Vous devez téléverser un fichier pour continuer."}this.internals.setValidity(e,t,this.shadowElement);this.inputTitle=t}handleDrop(e){e.preventDefault();const t=e.dataTransfer.files;if(t&&t.length>0){const e=new DataTransfer;for(const i of t){e.items.add(i)}if(e.files.length>0){this.shadowElement.files=e.files;this.files=e.files}this.gcdsChange.emit(this.value);this.el.dispatchEvent(new Event("change",{bubbles:true,composed:true}));this.updateValidity()}this.shadowElement.focus()}updateLang(){const e=new MutationObserver((e=>{if(e[0].oldValue!=this.el.lang){this.lang=this.el.lang}}));e.observe(this.el,l)}async componentWillLoad(){this.lang=a(this.el);this.updateLang();this.validateDisabledSelect();this.validateHasError();this.validateErrorMessage();n(this.el,"file");this.validateValidator();this.inheritedAttributes=d(this.el,this.shadowElement)}async componentDidLoad(){this.updateValidity();if(this.autofocus){requestAnimationFrame((()=>{var e;(e=this.shadowElement)===null||e===void 0?void 0:e.focus()}))}}render(){const{accept:e,disabled:t,errorMessage:i,hasError:o,hint:l,label:a,hideLabel:d,lang:u,multiple:c,name:n,required:p,uploaderId:f,value:h,inputTitle:g,autofocus:b,form:m,inheritedAttributes:w}=this;const _=Object.assign(Object.assign({accept:e,disabled:t,multiple:c,name:n,required:p,value:h,title:g,autofocus:b,form:m},w),{"aria-describedby":`${w["aria-describedby"]?`${w["aria-describedby"]} `:""}file-uploader__summary`});const y={label:a,required:p};if(l||i){const e=l?`hint-${f} `:"";const t=i?`error-message-${f} `:"";_["aria-describedby"]=`${e}${t}${_["aria-describedby"]}`}return r(s,{key:"7f8da364ccd3dd2247eb3ca0acfdf626350bc935"},r("div",{key:"194df3b32d1751a1552d19a4a09f6794fd93e960",class:`gcds-file-uploader-wrapper ${t?"gcds-disabled":""} ${o?"gcds-error":""}`},r("gcds-label",Object.assign({key:"4ae5e97f811a21823866c153211ce7903175351e"},y,{"hide-label":d,"label-for":f,lang:u})),l?r("gcds-hint",{"hint-id":f},l):null,i?r("gcds-error-message",{messageId:f},i):null,r("div",{key:"f40d3488ea2aaa8d2833c4f1c988f67c847deb94",class:`file-uploader__input ${h.length>0?"uploaded-files":""}`,onDrop:e=>this.handleDrop(e),onDragOver:e=>e.preventDefault()},r("button",{key:"9ce270d208d451d2b240d8049d5b5a07a5bf1791",type:"button",tabindex:"-1",onClick:()=>this.shadowElement.click()},v[u].button.upload),r("input",Object.assign({key:"9ef4ac5e052c73626541fdfc3f2eb98fc65f4482",type:"file",id:f},_,{onBlur:()=>this.onBlur(),onFocus:()=>this.gcdsFocus.emit(),onInput:e=>this.handleInput(e,this.gcdsInput),onChange:e=>this.handleInput(e,this.gcdsChange),"aria-invalid":o?"true":"false",ref:e=>this.shadowElement=e})),h.length>0?r("gcds-sr-only",{id:"file-uploader__summary"},r("span",null,v[u].summary.selected," "),h.map((e=>r("span",null,e," ")))):r("gcds-sr-only",{id:"file-uploader__summary"},v[u].summary.unselected)),h.length>0?h.map((e=>r("div",{class:"file-uploader__uploaded-file","aria-label":`${v[u].removeFile} ${e}.`},r("gcds-text",{"margin-bottom":"0"},e),r("button",{onClick:e=>this.removeFile(e)},r("span",null,v[u].button.remove),r("gcds-icon",{name:"close",size:"text","margin-left":"150"}))))):null))}static get delegatesFocus(){return true}static get formAssociated(){return true}get el(){return this}static get watchers(){return{disabled:["validateDisabledSelect"],files:["watchFiles"],errorMessage:["validateErrorMessage"],validator:["validateValidator"],hasError:["validateHasError"]}}static get style(){return w}},[81,"gcds-file-uploader",{uploaderId:[1537,"uploader-id"],name:[1],label:[513],hideLabel:[4,"hide-label"],required:[516],disabled:[1540],value:[1040],accept:[513],multiple:[516],files:[1040],errorMessage:[1537,"error-message"],hint:[513],validator:[1040],validateOn:[1025,"validate-on"],validity:[2064],autofocus:[516],form:[513],hasError:[32],inheritedAttributes:[32],lang:[32],validate:[64],checkValidity:[64],getValidationMessage:[64]},[[4,"submit","submitListener"]],{disabled:["validateDisabledSelect"],files:["watchFiles"],errorMessage:["validateErrorMessage"],validator:["validateValidator"],hasError:["validateHasError"]}]);function y(){if(typeof customElements==="undefined"){return}const e=["gcds-file-uploader","gcds-error-message","gcds-hint","gcds-icon","gcds-label","gcds-sr-only","gcds-text"];e.forEach((e=>{switch(e){case"gcds-file-uploader":if(!customElements.get(e)){customElements.define(e,_)}break;case"gcds-error-message":if(!customElements.get(e)){p()}break;case"gcds-hint":if(!customElements.get(e)){f()}break;case"gcds-icon":if(!customElements.get(e)){h()}break;case"gcds-label":if(!customElements.get(e)){g()}break;case"gcds-sr-only":if(!customElements.get(e)){b()}break;case"gcds-text":if(!customElements.get(e)){m()}break}}))}const k=_;const x=y;export{k as GcdsFileUploader,x as defineCustomElement};
//# sourceMappingURL=gcds-file-uploader.js.map