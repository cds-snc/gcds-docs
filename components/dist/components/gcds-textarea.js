import{p as t,H as s,c as e,h as a,F as i,d as r}from"./p-BQgY5XdM.js";import{h as o,f as d,o as h,a as l,i as c}from"./p-DOKR5HKI.js";import{d as n,g as u,r as g}from"./p-1b8Kykha.js";import{d as f}from"./p-9ylu2Rg-.js";import{d as b}from"./p-D0pOKwNu.js";import{d as m}from"./p-CwNv12Ch.js";import{d as x}from"./p-Cc9yC5rG.js";import{d as p}from"./p-l4qjNkyj.js";import{d as v}from"./p-DA0OyRaS.js";const w={en:{characters:{left:"Characters left: ",maxlength:"You can enter up to {{num}} characters"}},fr:{characters:{left:"Caractères restants : ",maxlength:"Vous pouvez saisir jusqu'à {{num}} caractères"}}};const y="@layer reset, default, disabled, error, focus;@layer reset{:host{display:block}:host .gcds-textarea-wrapper{border:0;margin:0;padding:0}:host .gcds-textarea-wrapper textarea{box-sizing:border-box}}@layer default{:host .gcds-textarea-wrapper{color:var(--gcds-textarea-default-text);font:var(--gcds-textarea-font-desktop);max-width:75ch;transition:color .15s ease-in-out;width:100%}@media only screen and (width < 48em){:host .gcds-textarea-wrapper{font:var(--gcds-textarea-font-mobile)}}:host .gcds-textarea-wrapper textarea{background-color:var(--gcds-textarea-default-background);background-image:none;border:var(--gcds-textarea-border-width) solid;border-radius:var(--gcds-textarea-border-radius);color:var(--gcds-textarea-default-text);display:block;font:inherit;height:auto;margin:var(--gcds-textarea-margin)!important;max-width:100%;min-height:var(--gcds-textarea-min-height);min-width:50%;padding:var(--gcds-textarea-padding)!important;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out,outline .15s ease-in-out;width:100%}}@layer disabled{:host .gcds-textarea-wrapper.gcds-disabled{color:var(--gcds-textarea-disabled-text)}:host .gcds-textarea-wrapper.gcds-disabled gcds-label{--gcds-label-text:currentColor}:host .gcds-textarea-wrapper.gcds-disabled gcds-hint{--gcds-hint-text:currentColor}:host .gcds-textarea-wrapper.gcds-disabled textarea:disabled{background-color:var(--gcds-textarea-disabled-background);border-color:var(--gcds-textarea-disabled-text);cursor:not-allowed}}@layer error{:host .gcds-textarea-wrapper .error-message-container{display:block}:host .gcds-textarea-wrapper textarea.gcds-error:not(:focus){border-color:var(--gcds-textarea-danger-border)}}@layer focus{:host .gcds-textarea-wrapper:focus-within textarea:focus{border-color:var(--gcds-textarea-focus-border);box-shadow:var(--gcds-textarea-focus-box-shadow);outline:var(--gcds-textarea-outline-width) solid var(--gcds-textarea-focus-border);outline-offset:var(--gcds-textarea-border-width)}}";const k=t(class t extends s{constructor(){super();this.__registerHost();this.__attachShadow();this.gcdsFocus=e(this,"gcdsFocus");this.gcdsBlur=e(this,"gcdsBlur");this.gcdsChange=e(this,"gcdsChange");this.gcdsInput=e(this,"gcdsInput");this.gcdsError=e(this,"gcdsError");this.gcdsValid=e(this,"gcdsValid");this.internals=this.attachInternals();this.htmlValidationErrors=[];this.textareaTitle="";this.lastInputTimeStamp=null;this.lastInputValue="";this.valueChecker=null;this._validator=n;this.hideLimit=false;this.disabled=false;this.hideLabel=false;this.required=false;this.rows=5;this.validateOn="blur";this.inheritedAttributes={};this.onFocus=()=>{this.gcdsFocus.emit();this.valueChecker=window.setInterval((()=>{if(!this.lastInputTimeStamp||Date.now()-500>=this.lastInputTimeStamp){this.updateIfValueChanged()}}),1e3)};this.onBlur=()=>{if(this.validateOn=="blur"){this.validate()}this.gcdsBlur.emit();if(this.valueChecker){window.clearInterval(this.valueChecker)}};this.handleInput=(t,s)=>{const e=t.target&&t.target.value;this.value=e;this.internals.setFormValue(e?e:null);this.shadowElement.value=e;if(t.type==="change"){const s=new t.constructor(t.type,t);this.el.dispatchEvent(s)}else{this.updateValidity();if(this.maxlength){this.lastInputTimeStamp=Date.now()}}s.emit(this.value)}}validateDisabledTextarea(){if(this.required){this.disabled=false}}validateErrorMessage(){if(this.disabled){this.errorMessage=""}else if(!this.hasError&&this.errorMessage){this.hasError=true}else if(this.errorMessage==""){this.hasError=false}}watchValue(t){if(this.shadowElement){this.shadowElement.value=t||""}this.internals.setFormValue(t||null)}validateValidator(){this._validator=u(this.validator)}get validity(){return this.internals.validity}validateHasError(){if(this.disabled){this.hasError=false}}updateIfValueChanged(){if(this.shadowElement.value!==this.lastInputValue){this.lastInputValue=this.shadowElement.value;setTimeout((()=>{const t=this.el.shadowRoot.querySelector(`#textarea__sr-count-${this.textareaId}`);if(t){t.textContent=`${w[this.lang].characters.left}${this.value===undefined?this.maxlength:this.maxlength-this.value.length}`}}),1500)}}async validate(){o(this.el,this._validator.validate(this.value),this.label,this.gcdsError,this.gcdsValid,this.lang);if(this.required&&!this.internals.checkValidity()||!this.internals.checkValidity()){if(!this.internals.validity.valueMissing){this.errorMessage=d(this.htmlValidationErrors[0],this.lang,this.el);this.textareaTitle=this.errorMessage}}}async checkValidity(){return this.internals.checkValidity()}async getValidationMessage(){return this.internals.validationMessage}submitListener(t){if(t.target==this.el.closest("form")){if(this.validateOn&&this.validateOn!="other"){this.validate()}if(this.hasError&&this.validateOn!="other"){t.preventDefault()}}}formResetCallback(){if(this.value!==this.initialValue){this.value=this.initialValue;if(this.shadowElement){this.shadowElement.value=this.initialValue||""}this.internals.setFormValue(this.initialValue||null)}}formStateRestoreCallback(t){this.internals.setFormValue(t);this.value=t}updateValidity(t){const s=this.shadowElement.validity;this.htmlValidationErrors=[];for(const t in s){if(s[t]===true&&t!=="valid"){this.htmlValidationErrors.push(t)}}for(const s in t){this.htmlValidationErrors.push(s)}const e=t?Object.assign(Object.assign({},this.shadowElement.validity),t):this.shadowElement.validity;let a=null;if(this.htmlValidationErrors.length>0){a=d(this.htmlValidationErrors[0],this.lang,this.el)}this.internals.setValidity(e,a,this.shadowElement);this.textareaTitle=a}updateLang(){const t=new MutationObserver((t=>{if(t[0].oldValue!=this.el.lang){this.lang=this.el.lang}}));t.observe(this.el,h)}async componentWillLoad(){this.lang=l(this.el);this.updateLang();this.validateDisabledTextarea();this.validateHasError();this.validateErrorMessage();g(this.el,"textarea");this.validateValidator();this.inheritedAttributes=c(this.el,this.shadowElement,["placeholder"]);this.internals.setFormValue(this.value?this.value:null);this.initialValue=this.value?this.value:null;this.lastInputValue=this.value?this.value:""}componentDidLoad(){let t;if(this.value&&(this.minlength||this.maxlength)){if(this.minlength&&this.value.length<this.minlength){t={tooShort:true}}else if(this.maxlength&&this.value.length>this.maxlength){t={tooLong:true}}}this.updateValidity(t);if(this.autofocus){requestAnimationFrame((()=>{var t;(t=this.shadowElement)===null||t===void 0?void 0:t.focus()}))}}render(){const{autofocus:t,cols:s,disabled:e,errorMessage:o,form:d,hideLabel:h,hideLimit:l,hint:c,label:n,maxlength:u,minlength:g,required:f,rows:b,textareaId:m,value:x,hasError:p,inheritedAttributes:v,lang:y,name:k,textareaTitle:E}=this;const $={maxWidth:`${s*1.5}ch`};const j={label:n,required:f};const V=Object.assign({name:k,autofocus:t,disabled:e,form:d,maxlength:u,minlength:g,required:f,rows:b,title:E},v);if(c||o||u){const t=c?`hint-${m} `:"";const s=o?`error-message-${m} `:"";const e=u?`textarea__count-${m} `:"";V["aria-describedby"]=`${t}${s}${e}${V["aria-describedby"]?`${V["aria-describedby"]}`:""}`}return a(r,{key:"5f44ed3469dff257e990ce0350f4fbd8553c9a0d"},a("div",{key:"b4ab687437aa45420a5701170f7d3f8aef67a73d",class:`gcds-textarea-wrapper ${e?"gcds-disabled":""} ${p?"gcds-error":""}`},a("gcds-label",Object.assign({key:"9ece7412c657f8a1c554075912db279a3c8a8c35"},j,{"hide-label":h,"label-for":m,lang:y})),c?a("gcds-hint",{"hint-id":m},c):null,o?a("gcds-error-message",{messageId:m},o):null,a("textarea",Object.assign({key:"2a010536fbba3c406b18df2f0dbb5d3e07fd1964"},V,{class:p?"gcds-error":null,id:m,onBlur:()=>this.onBlur(),onFocus:()=>this.onFocus(),onInput:t=>this.handleInput(t,this.gcdsInput),onChange:t=>this.handleInput(t,this.gcdsChange),"aria-labelledby":`label-for-${m}`,"aria-invalid":o?"true":"false",style:s?$:null,ref:t=>this.shadowElement=t}),x),u?a(i,null,a("gcds-sr-only",{tag:"span",id:`textarea__count-${m}`},w[y].characters.maxlength.replace("{{num}}",u)),!l&&a("gcds-text",{id:`textarea__visual-count-${m}`,"aria-hidden":"true"},w[y].characters.left,x==undefined?u:u-x.length),a("gcds-sr-only",{tag:"span"},a("span",{id:`textarea__sr-count-${m}`,role:"status","aria-atomic":"true"}))):null))}static get delegatesFocus(){return true}static get formAssociated(){return true}get el(){return this}static get watchers(){return{disabled:["validateDisabledTextarea"],errorMessage:["validateErrorMessage"],value:["watchValue"],validator:["validateValidator"],hasError:["validateHasError"]}}static get style(){return y}},[81,"gcds-textarea",{autofocus:[516],form:[513],hideLimit:[4,"hide-limit"],maxlength:[514],minlength:[514],cols:[2],disabled:[1028],errorMessage:[1025,"error-message"],hideLabel:[4,"hide-label"],hint:[1],label:[1],name:[1],required:[4],rows:[2],textareaId:[1,"textarea-id"],value:[1025],validator:[1040],validateOn:[1025,"validate-on"],validity:[2064],inheritedAttributes:[32],hasError:[32],lang:[32],validate:[64],checkValidity:[64],getValidationMessage:[64]},[[4,"submit","submitListener"]],{disabled:["validateDisabledTextarea"],errorMessage:["validateErrorMessage"],value:["watchValue"],validator:["validateValidator"],hasError:["validateHasError"]}]);function E(){if(typeof customElements==="undefined"){return}const t=["gcds-textarea","gcds-error-message","gcds-hint","gcds-icon","gcds-label","gcds-sr-only","gcds-text"];t.forEach((t=>{switch(t){case"gcds-textarea":if(!customElements.get(t)){customElements.define(t,k)}break;case"gcds-error-message":if(!customElements.get(t)){f()}break;case"gcds-hint":if(!customElements.get(t)){b()}break;case"gcds-icon":if(!customElements.get(t)){m()}break;case"gcds-label":if(!customElements.get(t)){x()}break;case"gcds-sr-only":if(!customElements.get(t)){p()}break;case"gcds-text":if(!customElements.get(t)){v()}break}}))}const $=k;const j=E;export{$ as GcdsTextarea,j as defineCustomElement};
//# sourceMappingURL=gcds-textarea.js.map