import{p as t,H as e,c as i,h as s,d as a}from"./p-BQgY5XdM.js";import{h as r,o as n,a as d,l as o,g as l}from"./p-DOKR5HKI.js";import{d as h,g as c,a as u,r as f}from"./p-1b8Kykha.js";import{d as m}from"./p-Dff2I2ku.js";import{d as g}from"./p-CZq1Zpp8.js";import{d as p}from"./p-CwNv12Ch.js";import{d as v}from"./p-DjiKE_2U.js";import{d as b}from"./p-Cc9yC5rG.js";import{d as y}from"./p-CJyX7e_U.js";import{d as _}from"./p-DeFvi7Po.js";const k={en:{year:"Year",month:"Month",day:"Day",selectmonth:"Select a month",months:{"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},valueError:"gcds-date-input:  Value attribute contains an invalid date format. Expected format: ",valueFormatfull:"YYYY-MM-DD",valueFormatcompact:"YYYY-MM",required:" (required)",rangeUnderflow:"Date must be on or after {{min}}.",rangeOverflow:"Date must be on or before {{max}}."},fr:{year:"Année",month:"Mois",day:"Jour",selectmonth:"Sélectionnez un mois",months:{"01":"janvier","02":"février","03":"mars","04":"avril","05":"mai","06":"juin","07":"juillet","08":"août","09":"septembre",10:"octobre",11:"novembre",12:"décembre"},valueError:"gcds-date-input:  Value attribute contains an invalid date format. Expected format: ",valueFormatfull:"YYYY-MM-DD",valueFormatcompact:"YYYY-MM",required:" (obligatoire)",rangeUnderflow:"La date doit être le {{min}} ou après.",rangeOverflow:"La date doit être le {{max}} ou avant."}};const M="@layer reset, default, hint, error;@layer reset{:host{display:block}:host .gcds-date-input__fieldset{border:0;min-inline-size:auto;padding:0}:host .gcds-date-input__fieldset legend{padding:0}}@layer default{:host .gcds-date-input__fieldset legend{color:var(--gcds-date-input-fieldset-text);font:var(--gcds-date-input-fieldset-font-desktop)}:host .gcds-date-input__fieldset legend .legend__required{font:var(--gcds-date-input-fieldset-required-font-desktop);margin:var(--gcds-date-input-fieldset-required-margin)!important;vertical-align:middle}@media only screen and (width < 48em){:host .gcds-date-input__fieldset legend{font:var(--gcds-date-input-fieldset-font-mobile)}:host .gcds-date-input__fieldset legend .legend__required{font:var(--gcds-date-input-fieldset-required-font-mobile)}}:host .gcds-date-input__day,:host .gcds-date-input__month,:host .gcds-date-input__year{display:inline-block;margin-inline-end:var(--gcds-date-input-margin);--gcds-label-font-desktop:var(--gcds-date-input-label-font-desktop);--gcds-label-font-mobile:var(--gcds-date-input-label-font-mobile )}}@layer hint{:host gcds-hint{margin:var(--gcds-date-input-fieldset-hint-margin)}}@layer error{:host gcds-input.gcds-date-input--error::part(input),:host gcds-select.gcds-date-input--error::part(select){border-color:var(--gcds-date-input-danger-border)}}";const V=t(class t extends e{constructor(){super();this.__registerHost();this.__attachShadow();this.gcdsFocus=i(this,"gcdsFocus");this.gcdsBlur=i(this,"gcdsBlur");this.gcdsInput=i(this,"gcdsInput");this.gcdsChange=i(this,"gcdsChange");this.gcdsError=i(this,"gcdsError");this.gcdsValid=i(this,"gcdsValid");this.internals=this.attachInternals();this.htmlValidationErrors=[];this._validator=h;this.required=false;this.disabled=false;this.validateOn="blur";this.monthValue="";this.dayValue="";this.yearValue="";this.hasError={day:false,month:false,year:false};this.errors=[];this.onBlur=()=>{if(this.validateOn=="blur"){this.validate()}};this.handleInput=(t,e)=>{const i=t.target&&t.target.value;if(e==="year"){this.yearValue=i}else if(e==="month"){this.monthValue=i}else if(e==="day"){this.dayValue=i}this.setValue();if(t.type==="change"){const e=new t.constructor(t.type,t);this.el.dispatchEvent(e)}}}validateName(){if(!this.name){this.errors.push("name")}else if(this.errors.includes("name")){this.errors.splice(this.errors.indexOf("name"),1)}}validateLegend(){if(!this.legend){this.errors.push("legend")}else if(this.errors.includes("legend")){this.errors.splice(this.errors.indexOf("legend"),1)}}validateFormat(){if(!this.format||this.format!="full"&&this.format!="compact"){this.errors.push("format")}else if(this.errors.includes("format")){this.errors.splice(this.errors.indexOf("format"),1)}}watchValue(){if(this.value){this.splitFormValue();this.internals.setFormValue(this.value)}else{this.yearValue="";this.monthValue="";this.dayValue="";this.internals.setFormValue(null)}this.updateValidity()}get validity(){return this.internals.validity}validateValidator(){this._validator=c(this.validator)}async validate(){var t,e,i,s;this.hasError=r(this.el,this._validator.validate(this.format==="full"?`${this.yearValue}-${this.monthValue}-${this.dayValue}`:`${this.yearValue}-${this.monthValue}`),this.legend,this.gcdsError,this.gcdsValid,this.lang,{day:false,month:false,year:false});if(!this.internals.checkValidity()&&!((t=this.internals.validity)===null||t===void 0?void 0:t.valueMissing)&&!((e=this.internals.validity)===null||e===void 0?void 0:e.badInput)){this.errorMessage=(i=this.htmlValidationErrors[0])===null||i===void 0?void 0:i.errorMessage;this.hasError=Object.assign(Object.assign({},this.hasError),(s=this.htmlValidationErrors[0])===null||s===void 0?void 0:s.hasError)}}async checkValidity(){return this.internals.checkValidity()}async getValidationMessage(){return this.internals.validationMessage}async submitListener(t){if(t.target==this.el.closest("form")){if(this.validateOn&&this.validateOn!="other"){this.validate()}for(const e in this.hasError){if(this.hasError[e]&&this.validateOn!="other"){t.preventDefault()}}}}formResetCallback(){if(this.value!=this.initialValue){this.internals.setFormValue(this.initialValue);this.value=this.initialValue}}formStateRestoreCallback(t){this.internals.setFormValue(t);this.value=t}checkAndValidateValidity(){var t,e,i,s,a,r;const n=[this.monthSelect,this.yearInput];if(this.format==="full"){this.lang==="en"?n.splice(1,0,this.dayInput):n.unshift(this.dayInput)}this.htmlValidationErrors=[];let d=true;let o=false;let l=false;let h=false;let c=false;let f=[];let m=null;if(this.required||this.value!=null){n.forEach((t=>{if(t.value===""||t.value==null){o=true;d=false;f.push(t)}}));m=u({day:(t=this.dayInput)===null||t===void 0?void 0:t.value,month:(e=this.monthSelect)===null||e===void 0?void 0:e.value,year:(i=this.yearInput)===null||i===void 0?void 0:i.value},this.format).reason[this.lang]}if(this.required&&!o){const t=u({day:(s=this.dayInput)===null||s===void 0?void 0:s.value,month:(a=this.monthSelect)===null||a===void 0?void 0:a.value,year:(r=this.yearInput)===null||r===void 0?void 0:r.value},this.format);if(t.reason.en!=""){l=true;m=t.reason[this.lang];f=n;this.htmlValidationErrors.push({error:"badInput",hasError:t.errors,errorMessage:m})}}if(this.value!=null&&this.min&&!o&&!l){const t=new Date(this.value);const e=new Date(this.min);if(t<e){d=false;h=true;f=n;m=k[this.lang].rangeUnderflow.replace("{{min}}",this.min);this.htmlValidationErrors.push({error:"rangeUnderflow",hasError:{day:true,month:true,year:true},errorMessage:m})}}if(this.value!=null&&this.max&&!o&&!l&&!h){const t=new Date(this.value);const e=new Date(this.max);if(t>e){d=false;c=true;m=k[this.lang].rangeOverflow.replace("{{max}}",this.max);this.htmlValidationErrors.push({error:"rangeOverflow",hasError:{day:true,month:true,year:true},errorMessage:m});f=n}}const g={valueMissing:o,typeMismatch:false,patternMismatch:false,tooLong:false,tooShort:false,rangeUnderflow:h,rangeOverflow:c,stepMismatch:false,badInput:l,customError:false,valid:d};return{validity:g,formError:f,errorMessage:m}}updateValidity(){if(this.format==="full"&&(!this.yearInput||!this.monthSelect||!this.dayInput)||this.format==="compact"&&(!this.yearInput||!this.monthSelect))return;const{validity:t,formError:e,errorMessage:i}=this.checkAndValidateValidity();let s=null;if((t===null||t===void 0?void 0:t.valueMissing)||(t===null||t===void 0?void 0:t.badInput)||(t===null||t===void 0?void 0:t.rangeUnderflow)||(t===null||t===void 0?void 0:t.rangeOverflow)){s=i}this.internals.setValidity(t,s,e[0])}updateLang(){const t=new MutationObserver((t=>{if(t[0].oldValue!=this.el.lang){this.lang=this.el.lang}}));t.observe(this.el,n)}setValue(){const{yearValue:t,monthValue:e,format:i}=this;let{dayValue:s}=this;if(s&&s.length===1&&s!="0"){s="0"+s;this.dayValue=s}else if(s&&s.length==3&&s[0]==="0"){s=s.substring(1);this.dayValue=s}if(i==="full"){this.value=`${t}-${e}-${s}`}else if(i==="compact"){this.value=`${t}-${e}`}this.internals.setFormValue(this.value);this.updateValidity();return true}splitFormValue(){if(this.format=="compact"){const t=this.value.split("-");this.yearValue=t[0];this.monthValue=t[1]}else{const t=this.value.split("-");this.yearValue=t[0];this.monthValue=t[1];this.dayValue=t[2]}}validateRequiredProps(){this.validateName();this.validateLegend();this.validateFormat();if(this.errors.includes("name")||this.errors.includes("legend")||this.errors.includes("format")){return false}return true}async componentWillLoad(){this.lang=d(this.el);this.updateLang();f(this.el,"date-input");this.validateValidator();const t=this.validateRequiredProps();if(!t){o("gcds-date-input",this.errors)}this.watchValue();if(this.value&&l(this.value)){this.splitFormValue();this.setValue();this.initialValue=this.value}}async componentDidLoad(){this.updateValidity();if(this.autofocus){requestAnimationFrame((()=>{var t;(t=this.fieldset)===null||t===void 0?void 0:t.focus()}))}}render(){const{legend:t,name:e,format:i,required:r,hint:n,errorMessage:d,disabled:o,lang:l,hasError:h,form:c}=this;const u={};if(r){u["aria-required"]="true"}const f={tabindex:"-1","aria-labelledby":"date-input-legend"};if(n){const t=this.hint?`date-input-hint `:"";f["aria-labelledby"]=`${f["aria-labelledby"]} ${t}`.trim()}const m=Array.from({length:12},((t,e)=>e+1<10?`0${e+1}`:`${e+1}`));const g=s("gcds-select",Object.assign({key:"3825d2fc422c6291c0c4ec02ba160ce18a8f885d",label:k[l].month,selectId:"month",name:"month",defaultValue:k[l].selectmonth,disabled:o,onInput:t=>this.handleInput(t,"month"),onChange:t=>this.handleInput(t,"month"),value:this.monthValue,class:`gcds-date-input__month ${h["month"]?"gcds-date-input--error":""}`},u,{"aria-invalid":h["month"].toString(),"aria-description":h["month"]&&d,form:c,ref:t=>this.monthSelect=t}),m.map((t=>s("option",{key:t,value:t},k[l]["months"][t]))));const p=s("gcds-input",Object.assign({key:"1e6d8f1f6fb1b3199aadfa1f7ad4dcd48f52f8c0",name:"year",label:k[l].year,inputId:"year",type:"number",inputmode:"numeric",size:4,disabled:o,value:this.yearValue,onInput:t=>this.handleInput(t,"year"),onChange:t=>this.handleInput(t,"year"),class:`gcds-date-input__year ${h["year"]?"gcds-date-input--error":""}`,"validate-on":"other"},u,{"aria-invalid":h["year"].toString(),"aria-description":h["year"]&&d,form:c,ref:t=>this.yearInput=t}));const v=s("gcds-input",Object.assign({key:"727e8f60daec7e1b873aa8f27a10d943e1f98d34",name:"day",label:k[l].day,inputId:"day",type:"number",inputmode:"numeric",size:2,disabled:o,value:this.dayValue,onInput:t=>this.handleInput(t,"day"),onChange:t=>this.handleInput(t,"day"),"validate-on":"other",class:`gcds-date-input__day ${h["day"]?"gcds-date-input--error":""}`},u,{"aria-invalid":h["day"].toString(),"aria-description":h["day"]&&d,form:c,ref:t=>this.dayInput=t}));return s(a,{key:"4c09f8426752a32086163716b8fc81abccb9e539",name:e,onBlur:()=>this.onBlur()},this.validateRequiredProps()&&s("fieldset",Object.assign({key:"30d06040710f4c8008e2fbf58965ac7366237ab9",class:"gcds-date-input__fieldset"},f,{ref:t=>this.fieldset=t}),s("legend",{key:"457b053792630a37e04b5a37156fa91d6c292bfe",id:"date-input-legend"},t,r?s("span",{class:"legend__required"},k[l].required):null),n?s("gcds-hint",{id:"date-input-hint","hint-id":"date-input"},n):null,d?s("div",null,s("gcds-error-message",{id:"date-input-error",messageId:"date-input"},d)):null,i=="compact"?[g,p]:l=="en"?[g,v,p]:[v,g,p]))}static get delegatesFocus(){return true}static get formAssociated(){return true}get el(){return this}static get watchers(){return{name:["validateName"],legend:["validateLegend"],format:["validateFormat"],value:["watchValue"],validator:["validateValidator"]}}static get style(){return M}},[81,"gcds-date-input",{name:[1],legend:[1],format:[1],value:[1025],required:[4],hint:[1],errorMessage:[1025,"error-message"],disabled:[1028],autofocus:[516],max:[513],min:[513],form:[513],validity:[2064],validator:[1040],validateOn:[1025,"validate-on"],monthValue:[32],dayValue:[32],yearValue:[32],hasError:[32],errors:[32],lang:[32],validate:[64],checkValidity:[64],getValidationMessage:[64]},[[4,"submit","submitListener"]],{name:["validateName"],legend:["validateLegend"],format:["validateFormat"],value:["watchValue"],validator:["validateValidator"]}]);function E(){if(typeof customElements==="undefined"){return}const t=["gcds-date-input","gcds-error-message","gcds-hint","gcds-icon","gcds-input","gcds-label","gcds-select","gcds-text"];t.forEach((t=>{switch(t){case"gcds-date-input":if(!customElements.get(t)){customElements.define(t,V)}break;case"gcds-error-message":if(!customElements.get(t)){m()}break;case"gcds-hint":if(!customElements.get(t)){g()}break;case"gcds-icon":if(!customElements.get(t)){p()}break;case"gcds-input":if(!customElements.get(t)){v()}break;case"gcds-label":if(!customElements.get(t)){b()}break;case"gcds-select":if(!customElements.get(t)){y()}break;case"gcds-text":if(!customElements.get(t)){_()}break}}))}const w=V;const j=E;export{w as GcdsDateInput,j as defineCustomElement};
//# sourceMappingURL=gcds-date-input.js.map