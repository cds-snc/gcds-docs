{"file":"utils2.js","mappings":"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","names":[],"sources":["src/utils/menus/utils.ts"],"sourcesContent":["/**\n * Handle event for keyboard control of nav\n * @param {Event} event\n * @param {Element} nav\n * @param {any[]} queue\n */\nexport async function handleKeyDownNav(event, nav, queue) {\n  const key = event.key;\n  const currentIndex = queue.indexOf(\n    document.activeElement == nav\n      ? document.activeElement.shadowRoot.activeElement\n      : document.activeElement,\n  );\n  const activeElement = queue[currentIndex];\n\n  switch (key) {\n    // Down arrow\n    case 'ArrowDown':\n      event.preventDefault();\n      // If on last item, jump to first item\n      if (currentIndex + 1 > queue.length - 1) {\n        await focusNavItem(0, queue);\n        // Jump to next item\n      } else {\n        await focusNavItem(currentIndex + 1, queue);\n      }\n      break;\n\n    // Up arrow\n    case 'ArrowUp':\n      event.preventDefault();\n      // If on first item, jump to last item\n      if (currentIndex - 1 < 0) {\n        await focusNavItem(queue.length - 1, queue);\n        // Jump to previous item\n      } else {\n        await focusNavItem(currentIndex - 1, queue);\n      }\n      break;\n\n    // Right arrow\n    case 'ArrowRight':\n      event.preventDefault();\n      if (\n        activeElement.nodeName == 'GCDS-NAV-GROUP' &&\n        !activeElement.hasAttribute('open')\n      ) {\n        await toggleNavGroup(activeElement, nav);\n      }\n      break;\n\n    // Left arrow || ESC\n    case 'ArrowLeft':\n    case 'Escape':\n      event.preventDefault();\n      // Currently focusing a gcds-nav-group\n      if (\n        activeElement.nodeName == 'GCDS-NAV-GROUP' &&\n        activeElement.hasAttribute('open')\n      ) {\n        await toggleNavGroup(activeElement, nav);\n        // Currently focus within a gcds-nav-group\n      } else if (activeElement.parentNode.nodeName == 'GCDS-NAV-GROUP') {\n        await toggleNavGroup(activeElement.parentNode, nav);\n      } else if (\n        activeElement.parentNode == nav &&\n        (await (\n          activeElement.parentNode as HTMLGcdsTopNavElement\n        ).getNavSize()) == 'mobile'\n      ) {\n        await toggleNavGroup(queue[queue.length - 1], nav);\n      }\n      break;\n\n    // Tab - special logic on mobile screen size\n    case 'Tab':\n      if ((await nav.getNavSize()) == 'mobile') {\n        // shift + tab\n        if (event.shiftKey) {\n          if (\n            currentIndex == queue.length - 1 &&\n            activeElement.hasAttribute('open')\n          ) {\n            event.preventDefault();\n            await focusNavItem(queue.length - 2, queue);\n          }\n        } else {\n          // tab\n          if (currentIndex == queue.length - 2) {\n            event.preventDefault();\n            await focusNavItem(queue.length - 1, queue);\n          }\n        }\n      }\n      break;\n\n    // ENTER || SPACEBAR\n    case 'Enter':\n    case ' ':\n      if (activeElement.nodeName == 'GCDS-NAV-GROUP') {\n        event.preventDefault();\n        await toggleNavGroup(activeElement, nav);\n      }\n      break;\n  }\n}\n\n/**\n * Focus nav element\n * @param {Number} index\n * @param {any[]} queue\n */\nasync function focusNavItem(index, queue) {\n  if (queue[index].nodeName == 'GCDS-NAV-LINK') {\n    (queue[index] as HTMLGcdsNavLinkElement).focusLink();\n  } else if (queue[index].nodeName == 'GCDS-NAV-GROUP') {\n    (queue[index] as HTMLGcdsNavGroupElement).focusTrigger();\n  }\n}\n\n/**\n *\n * @param {Element} group\n * @param {Element} nav\n */\nasync function toggleNavGroup(group, nav) {\n  const navGroup = group as HTMLGcdsNavGroupElement;\n\n  // Close nav group\n  if (navGroup.hasAttribute('open')) {\n    await navGroup.toggleNav();\n    navGroup.focusTrigger();\n\n    nav.updateNavItemQueue(nav);\n\n    // Open nav group\n  } else {\n    await navGroup.toggleNav();\n\n    setTimeout(async () => {\n      await focusNavItem(\n        0,\n        document.activeElement == nav ? nav.children : navGroup.children,\n      );\n    }, 10);\n\n    nav.updateNavItemQueue(nav);\n  }\n}\n\n/**\n * Return array of child elements of passed element\n * @param {Element} el\n * @return {any[]} indexedItems\n */\nexport async function getNavItems(el) {\n  const indexedItems: Array<any> = Array.from(el.children);\n\n  indexedItems.forEach(async item => {\n    if (\n      item.nodeName == 'GCDS-NAV-GROUP' &&\n      (item as HTMLGcdsNavGroupElement).open\n    ) {\n      const groupChildren = await getNavItems(item);\n      indexedItems.splice(indexedItems.indexOf(item) + 1, 0, ...groupChildren);\n    }\n  });\n\n  return indexedItems;\n}\n"],"version":3}