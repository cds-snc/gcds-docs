import{p as r,H as s,h as e,c as t}from"./p-CmJ5P5Sp.js";import{o as i,a as o}from"./p-BphlHDEW.js";import{d as a}from"./p-BF6hW4xX.js";import{d as n}from"./p-Vne11OgD.js";import{d as m}from"./p-DZolkXLi.js";const c={en:{heading:"There was a problem",subheading:"Errors were found on this page:"},fr:{heading:"Un problème est survenu",subheading:"Des erreurs ont été trouvées sur cette page :"}};const d="@layer reset, default, compact;@layer reset{:host{display:block}}@layer default{:host{container:component summary/inline-size}:host .gcds-error-summary{border:var(--gcds-error-summary-border-width) solid var(--gcds-error-summary-border-color);color:var(--gcds-error-summary-text);display:none;margin:var(--gcds-error-summary-margin);padding:var(--gcds-error-summary-padding);transition:background .15s ease-in-out,border .15s ease-in-out,color .15s ease-in-out}:host .gcds-error-summary.gcds-show{display:block}:host .gcds-error-summary .summary__errorlist{margin:var(--gcds-error-summary-list-margin);padding:0}:host .gcds-error-summary .summary__errorlist .summary__listitem{max-width:var(--gcds-error-summary-max-width)}:host .gcds-error-summary .summary__errorlist .summary__listitem:not(:last-child){padding:var(--gcds-error-summary-list-item-padding)}:host .gcds-error-summary .summary__errorlist .summary__listitem gcds-link::part(link):not(:focus){color:var(--gcds-error-summary-link-color)}}@layer compact{@container summary (width < 24em){:host .gcds-error-summary{padding:var(--gcds-error-summary-mobile-padding)}}}";const h=r(class r extends s{constructor(){super();this.__registerHost();this.__attachShadow();this.listen=true;this.errorLinksObject={};this.errorQueue={};this.hasSubmitted=false}listenChanged(){if(this.errorLinks){this.listen=false}}errorLinksChanged(r){if(typeof r=="string"){this.errorLinks=JSON.parse(r)}else if(typeof r=="object"){this.errorLinks=r}this.errorQueue=this.errorLinks;if(this.listen){this.listen=false}}errorListener(r){if(this.listen&&r.target.closest("form")==this.el.closest("form")){this.errorLinksObject[r.detail.message]=r.target}}validListener(r){if(this.listen&&r.target.closest("form")==this.el.closest("form")){for(const[s,e]of Object.entries(this.errorLinksObject)){if(e==r.target){delete this.errorLinksObject[s]}}if(this.errorQueue){const r=this.sortErrors();this.errorQueue=Object.assign({},r)}}}submitListener(r){if(this.listen&&r.target.closest("form")==this.el.closest("form")){this.hasSubmitted=true;setTimeout((()=>{const r=this.sortErrors();this.errorQueue=Object.assign({},r);setTimeout((()=>{this.shadowElement.focus()}),50)}),100)}}sortErrors(){const r=Object.entries(this.errorLinksObject).map((([r,s])=>[r,s,s.getBoundingClientRect().y]));r.sort((function(r,s){return r[2]-s[2]}));const s={};r.forEach((function(r){s[r[0]]=r[1]}));return s}focusElement(r){var s;const e=document.querySelector(r);let t=`[for=${r.replace("#","")}]`;(s=e.closest("form").querySelector(t))===null||s===void 0?void 0:s.scrollIntoView();e.focus()}updateLang(){const r=new MutationObserver((r=>{if(r[0].oldValue!=this.el.lang){this.lang=this.el.lang}}));r.observe(this.el,i)}async componentWillLoad(){this.lang=o(this.el);this.updateLang();this.listenChanged();if(this.errorLinks&&typeof this.errorLinks=="string"){this.errorQueue=Object.assign({},JSON.parse(this.errorLinks))}else if(this.errorLinks&&typeof this.errorLinks=="object"){this.errorQueue=Object.assign({},this.errorLinks)}}render(){const{heading:r,errorQueue:s,lang:i,hasSubmitted:o,errorLinks:a}=this;return e(t,{key:"921bc4798b6c8ce0e52cc0e8377548d2f9f90a06"},e("div",{key:"c88ac2207f650dfcf2afc92c2382261e6062103d",role:"alert",tabindex:"-1",ref:r=>this.shadowElement=r,class:`gcds-error-summary ${(o||a)&&Object.keys(s).length>0?"gcds-show":""}`},e("gcds-heading",{key:"3503d99d5747612a36354097ebe466c88311e4dc",tag:"h2","margin-top":"0","margin-bottom":"225"},r!==null&&r!==void 0?r:c[i].heading),e("ol",{key:"0751c01bfe6c44457fb9923c814fa1831aae4444",class:"summary__errorlist"},(o||a)&&Object.keys(s).length>0&&Object.keys(s).map((r=>e("li",{class:"summary__listitem"},e("gcds-link",{size:"regular",href:a?r:"#",onClick:e=>{e.preventDefault();a?this.focusElement(r):s[r].focus()}},a?s[r]:r)))))))}get el(){return this}static get watchers(){return{listen:["listenChanged"],errorLinks:["errorLinksChanged"]}}static get style(){return d}},[1,"gcds-error-summary",{heading:[513],listen:[1028],errorLinks:[1025,"error-links"],lang:[32],errorQueue:[32],hasSubmitted:[32]},[[4,"gcdsError","errorListener"],[4,"gcdsValid","validListener"],[4,"submit","submitListener"]],{listen:["listenChanged"],errorLinks:["errorLinksChanged"]}]);function l(){if(typeof customElements==="undefined"){return}const r=["gcds-error-summary","gcds-heading","gcds-icon","gcds-link"];r.forEach((r=>{switch(r){case"gcds-error-summary":if(!customElements.get(r)){customElements.define(r,h)}break;case"gcds-heading":if(!customElements.get(r)){a()}break;case"gcds-icon":if(!customElements.get(r)){n()}break;case"gcds-link":if(!customElements.get(r)){m()}break}}))}const u=h;const g=l;export{u as GcdsErrorSummary,g as defineCustomElement};
//# sourceMappingURL=gcds-error-summary.js.map