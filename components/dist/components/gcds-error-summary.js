import{p as s,H as r,c as e,h as t,d as i}from"./p-BQgY5XdM.js";import{o,a}from"./p-DOKR5HKI.js";import{d as n}from"./p-BhKHtvxe.js";import{d as c}from"./p-CwNv12Ch.js";import{d as m}from"./p-CHThIWTT.js";const d={en:{heading:"There was a problem",subheading:"Errors were found on this page:"},fr:{heading:"Un problème est survenu",subheading:"Des erreurs ont été trouvées sur cette page :"}};const h="@layer reset, default, compact;@layer reset{:host{display:block}}@layer default{:host{container:component summary/inline-size}:host .gcds-error-summary{border:var(--gcds-error-summary-border-width) solid var(--gcds-error-summary-border-color);color:var(--gcds-error-summary-text);display:none;margin:var(--gcds-error-summary-margin);padding:var(--gcds-error-summary-padding);transition:background .15s ease-in-out,border .15s ease-in-out,color .15s ease-in-out}:host .gcds-error-summary.gcds-show{display:block}:host .gcds-error-summary .summary__errorlist{margin:var(--gcds-error-summary-list-margin);padding:0}:host .gcds-error-summary .summary__errorlist .summary__listitem{max-width:var(--gcds-error-summary-max-width)}:host .gcds-error-summary .summary__errorlist .summary__listitem:not(:last-child){padding:var(--gcds-error-summary-list-item-padding)}:host .gcds-error-summary .summary__errorlist .summary__listitem gcds-link::part(link):not(:focus){color:var(--gcds-error-summary-link-color)}}@layer compact{@container summary (width < 24em){:host .gcds-error-summary{padding:var(--gcds-error-summary-mobile-padding)}}}";const u=s(class s extends r{constructor(){super();this.__registerHost();this.__attachShadow();this.gcdsFocus=e(this,"gcdsFocus");this.gcdsBlur=e(this,"gcdsBlur");this.gcdsClick=e(this,"gcdsClick");this.listen=true;this.errorLinksObject={};this.errorQueue={};this.hasSubmitted=false}listenChanged(){if(this.errorLinks){this.listen=false}}errorLinksChanged(s){if(typeof s=="string"){this.errorLinks=JSON.parse(s)}else if(typeof s=="object"){this.errorLinks=s}this.errorQueue=this.errorLinks;if(this.listen){this.listen=false}}errorListener(s){if(this.listen&&s.target.closest("form")==this.el.closest("form")){this.errorLinksObject[s.detail.message]=s.target}}validListener(s){if(this.listen&&s.target.closest("form")==this.el.closest("form")){for(const[r,e]of Object.entries(this.errorLinksObject)){if(e==s.target){delete this.errorLinksObject[r]}}if(this.errorQueue){const s=this.sortErrors();this.errorQueue=Object.assign({},s)}}}submitListener(s){if(this.listen&&s.target.closest("form")==this.el.closest("form")){this.hasSubmitted=true;setTimeout((()=>{const s=this.sortErrors();this.errorQueue=Object.assign({},s);setTimeout((()=>{this.shadowElement.focus()}),50)}),100)}}sortErrors(){const s=Object.entries(this.errorLinksObject).map((([s,r])=>[s,r,r.getBoundingClientRect().y]));s.sort((function(s,r){return s[2]-r[2]}));const r={};s.forEach((function(s){r[s[0]]=s[1]}));return r}focusElement(s){var r;const e=document.querySelector(s);const t=`[for=${s.replace("#","")}]`;(r=e.closest("form").querySelector(t))===null||r===void 0?void 0:r.scrollIntoView();e.focus()}updateLang(){const s=new MutationObserver((s=>{if(s[0].oldValue!=this.el.lang){this.lang=this.el.lang}}));s.observe(this.el,o)}async componentWillLoad(){this.lang=a(this.el);this.updateLang();this.listenChanged();if(this.errorLinks&&typeof this.errorLinks=="string"){this.errorQueue=Object.assign({},JSON.parse(this.errorLinks))}else if(this.errorLinks&&typeof this.errorLinks=="object"){this.errorQueue=Object.assign({},this.errorLinks)}}render(){const{heading:s,errorQueue:r,lang:e,hasSubmitted:o,errorLinks:a}=this;return t(i,{key:"a42f126a2bbbe41621a5c56d04c87b31e87d0363"},t("div",{key:"eeee2e16453b3c7911042cabb079ab072d3bcd09",role:"alert",tabindex:"-1",ref:s=>this.shadowElement=s,class:`gcds-error-summary ${(o||a)&&Object.keys(r).length>0?"gcds-show":""}`},t("gcds-heading",{key:"5c0aa122bc9f7a1dc250d856734d99befb88502e",tag:"h2","margin-top":"0","margin-bottom":"225"},s!==null&&s!==void 0?s:d[e].heading),t("ol",{key:"2fd12eca1a9ffe4f11aedfdd3b93d3a0becf7420",class:"summary__errorlist"},(o||a)&&Object.keys(r).length>0&&Object.keys(r).map((s=>t("li",{class:"summary__listitem"},t("gcds-link",{size:"regular",href:a?s:"#",onClick:e=>{e.preventDefault();a?this.focusElement(s):r[s].focus()}},a?r[s]:s)))))))}get el(){return this}static get watchers(){return{listen:["listenChanged"],errorLinks:["errorLinksChanged"]}}static get style(){return h}},[1,"gcds-error-summary",{heading:[513],listen:[1028],errorLinks:[1025,"error-links"],lang:[32],errorQueue:[32],hasSubmitted:[32]},[[4,"gcdsError","errorListener"],[4,"gcdsValid","validListener"],[4,"submit","submitListener"]],{listen:["listenChanged"],errorLinks:["errorLinksChanged"]}]);function l(){if(typeof customElements==="undefined"){return}const s=["gcds-error-summary","gcds-heading","gcds-icon","gcds-link"];s.forEach((s=>{switch(s){case"gcds-error-summary":if(!customElements.get(s)){customElements.define(s,u)}break;case"gcds-heading":if(!customElements.get(s)){n()}break;case"gcds-icon":if(!customElements.get(s)){c()}break;case"gcds-link":if(!customElements.get(s)){m()}break}}))}const g=u;const f=l;export{g as GcdsErrorSummary,f as defineCustomElement};
//# sourceMappingURL=gcds-error-summary.js.map