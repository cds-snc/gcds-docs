{"version":3,"file":"validator.js","sourceRoot":"","sources":["../../../src/validators/validator.ts"],"names":[],"mappings":"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","sourcesContent":["export interface ValidatorOld<A> {\n  validate: (x: A) => any;\n  errorMessage?: object;\n}\n\nexport interface ValidatorReturn {\n  valid: boolean;\n  reason: {\n    en: string;\n    fr: string;\n  };\n  errors?: object;\n}\n\nexport interface Validator<A> {\n  validate: (x: A) => ValidatorReturn;\n}\n\nexport interface ValidatorEntry {\n  name: string;\n  options?: unknown;\n}\n\nexport interface GcdsErrorInterface {\n  id: string;\n  message: string;\n}\n\nexport const defaultValidator: Validator<any> = {\n  validate: () => {\n    return {\n      valid: true,\n      reason: {\n        en: '',\n        fr: '',\n      },\n    };\n  },\n};\n\nexport function combineValidators<A>(\n  v1: Validator<A> | ValidatorOld<A>,\n  v2: Validator<A> | ValidatorOld<A>,\n): Validator<A> {\n  return {\n    validate: (x: A) => {\n      const res1 = v1.validate(x);\n      const res2 = v2.validate(x);\n\n      if (\n        (typeof res1 === 'object' && !res1.valid) ||\n        (typeof res1 === 'boolean' && !res1)\n      ) {\n        return typeof res1 === 'object'\n          ? res1\n          : { valid: res1, reason: (v1 as ValidatorOld<A>).errorMessage };\n      } else if (\n        (typeof res2 === 'object' && !res2.valid) ||\n        (typeof res2 === 'boolean' && !res2)\n      ) {\n        return typeof res2 === 'object'\n          ? res2\n          : { valid: res2, reason: (v2 as ValidatorOld<A>).errorMessage };\n      } else {\n        return {\n          valid: true,\n          reason: {\n            en: '',\n            fr: '',\n          },\n        };\n      }\n    },\n  };\n}\n\nexport function requiredValidator(element, type, subtype?) {\n  if (element.required) {\n    switch (type) {\n      // Components all validate the \"value\" property\n      case 'input':\n        switch (subtype) {\n          case 'email':\n            if (element.validator) {\n              element.validator.unshift('requiredEmailField');\n            } else {\n              element.validator = ['requiredEmailField'];\n            }\n            break;\n          default:\n            if (element.validator) {\n              element.validator.unshift('requiredField');\n            } else {\n              element.validator = ['requiredField'];\n            }\n            break;\n        }\n        break;\n      case 'select':\n        if (element.validator) {\n          element.validator.unshift('requiredSelectField');\n        } else {\n          element.validator = ['requiredSelectField'];\n        }\n        break;\n      case 'textarea':\n        if (element.validator) {\n          element.validator.unshift('requiredField');\n        } else {\n          element.validator = ['requiredField'];\n        }\n        break;\n      case 'file':\n        if (element.validator) {\n          element.validator.unshift('requiredFileInput');\n        } else {\n          element.validator = ['requiredFileInput'];\n        }\n        break;\n\n      case 'date-input':\n        if (element.validator) {\n          element.validator.unshift('requiredDateInput');\n        } else {\n          element.validator = ['requiredDateInput'];\n        }\n        break;\n      case 'radio':\n        if (element.validator) {\n          element.validator.unshift('requiredRadio');\n        } else {\n          element.validator = ['requiredRadio'];\n        }\n        break;\n      case 'checkboxGroup':\n        if (element.validator) {\n          element.validator.unshift('requiredCheckboxGroup');\n        } else {\n          element.validator = ['requiredCheckboxGroup'];\n        }\n        break;\n      case 'checkboxSingle':\n        if (element.validator) {\n          element.validator.unshift('requiredCheckboxSingle');\n        } else {\n          element.validator = ['requiredCheckboxSingle'];\n        }\n        break;\n    }\n  }\n}\n\n/*\nExample of parameter validator\n\nexport function getLengthValidator(min: number, max: number): Validator<string> {\n    // Create errorMessage object\n    let errorMessage = {};\n    if (min && max) {\n        errorMessage[\"en\"] = `You must enter between ${min} and ${max} characters`;\n        errorMessage[\"fr\"] = `French You must enter between ${min} and ${max} characters`;\n    } else if (min) {\n        errorMessage[\"en\"] = `You must enter at least ${min} characters`;\n        errorMessage[\"fr\"] = `French You must enter at least ${min} characters`;\n    } else if (max) {\n        errorMessage[\"en\"] = `You must enter less than ${max} characters`;\n        errorMessage[\"fr\"] = `French You must enter less than ${max} characters`;\n    }\n    return {\n        validate: (value: string) => {\n            value = value || '';\n            if (min && max) {\n                return min <= value.length && value.length <= max;\n            }\n            if (min) {\n                return min <= value.length;\n            }\n            if (max) {\n                return value.length <= max;\n            }\n            return true;\n        },\n        errorMessage\n    };\n}\n*/\n"]}